#!/bin/bash

cookbook_clone()
{
	local repo=$1
	local path=$2

	if [ ! -e $path ]; then
		git clone $repo $path
	fi

	(cd $path && git pull)
}

set -ex
cd $(dirname $0)/..

cookbook_clone https://github.com/fnichol/chef-rbenv cookbooks/rbenv
cookbook_clone https://github.com/fnichol/chef-ruby_build cookbooks/ruby_build
cookbook_cline https://github.com/opscode-cookbooks/firewall cookbooks/firewall

sudo chef-solo -c solo.rb -j nodes/localhost.json -N localhost
